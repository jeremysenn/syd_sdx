%div{:id => "item_#{id}_deductions_modal", :class => "modal fade deductions", :tabindex => "-1", :style => "display:none;"}
  .modal-dialog.modal-sm
    .modal-content
      .modal-header
        %strong Deductions
        = link_to "Ã—", '#', :class => "close", "data-dismiss" => "modal"
      .modal-body
        %ul.nav.nav-tabs
          %li.active
            %a{:href => "#weight_#{id}", :data => {:toggle => "tab"}}
              %i.fa.fa-balance-scale
              = "Weight"
          %li
            %a{:href => "#dollar_amount_#{id}", :data => {:toggle => "tab"}}
              %i.fa.fa-dollar
              = "Dollar Amount"
        .tab-content
          .tab-pane.active{:id => "weight_#{id}"}
            - unless line_item["DeductionCollection"].blank?
              - if line_item["DeductionCollection"].is_a? Hash # Only one line item deduction
                = line_item["DeductionCollection"]["ApiTicketItemDeduction"]["DeductDollarAmountDescription"] unless line_item["DeductionCollection"]["ApiTicketItemDeduction"]["DeductDollarAmountDescription"].blank?
                = number_to_currency(line_item["DeductionCollection"]["ApiTicketItemDeduction"]["DeductDollarAmount"]) unless line_item["DeductionCollection"]["ApiTicketItemDeduction"]["DeductDollarAmount"].blank? or line_item["DeductionCollection"]["ApiTicketItemDeduction"]["DeductDollarAmount"].to_i.zero?
                = line_item["DeductionCollection"]["ApiTicketItemDeduction"]["DeductWeightDescription"] unless line_item["DeductionCollection"]["ApiTicketItemDeduction"]["DeductWeightDescription"].blank?
                = line_item["DeductionCollection"]["ApiTicketItemDeduction"]["DeductWeight"] unless line_item["DeductionCollection"]["ApiTicketItemDeduction"]["DeductWeight"].blank?
              - else
                - line_item["DeductionCollection"].each do |line_item_deduction|
                  = line_item_deduction["ApiTicketItemDeduction"]["DeductDollarAmountDescription"] unless line_item_deduction["ApiTicketItemDeduction"]["DeductDollarAmountDescription"].blank?
                  = number_to_currency(line_item_deduction["ApiTicketItemDeduction"]["DeductDollarAmount"]) unless line_item_deduction["ApiTicketItemDeduction"]["DeductDollarAmount"].blank? or line_item_deduction["ApiTicketItemDeduction"]["DeductDollarAmount"].to_i.zero?
                  = line_item_deduction["ApiTicketItemDeduction"]["DeductWeightDescription"] unless line_item_deduction["ApiTicketItemDeduction"]["DeductWeightDescription"].blank?
                  = line_item_deduction["ApiTicketItemDeduction"]["DeductWeight"] unless line_item_deduction["ApiTicketItemDeduction"]["DeductWeight"].blank?
            - else
              None
            .row.form-group
              %div{:class => "col-xs-12"}
                = select_tag "ticket[line_items][][deductions][][deduct_weight_description]", options_for_select(@deductions_grouped_for_select, nil), prompt: '-- Reason --', class: "form-control input-lg"
            .row.form-group
              %div{:class => "col-xs-12"}
                = text_field_tag "ticket[line_items][][deductions][][deduct_weight]", nil, :placeholder => "Weight", class: "form-control input-lg"
              
          .tab-pane{:id => "dollar_amount_#{id}"}
            .row.form-group
              %div{:class => "col-xs-12"}
                = select_tag "ticket[line_items][][deductions][][deduct_dollar_amount_description]", options_for_select(@deductions_grouped_for_select, nil), prompt: '-- Reason --', class: "form-control input-lg"
            .row.form-group
              %div{:class => "col-xs-12"}
                = text_field_tag "ticket[line_items][][deductions][][deduct_dollar_amount]", nil, :placeholder => "Amount", class: "form-control input-lg"
              
      .modal-footer
        %button.btn.btn-default.btn-lg{"data-dismiss" => "modal", :type => "button"} Done

:javascript
  $('.modal').on('shown.bs.modal', function() {
    $(this).find('[autofocus]').first().focus();
  });