= render partial: "shared/navbars/edit_user_setting_navbar", locals: {title: "Settings"}

.jumbotron{style: 'background-color: white;'}
  .container
    
    = form_for @user_setting, :class => "form-inline" do |f|
      - @user_setting.errors.each do |attr, msg|
        .alert.alert-danger
          <button type="button" class="close" data-dismiss="alert">Ã—</button>
          = "#{attr} #{msg}" if @user_setting.errors[attr].first == msg
      .col-xs-12.col-sm-6
        %div.panel.panel-default
          %div.panel-heading
            %h5 Defaults
          %ul.list-group
            %li.list-group-item
              .row.form-group
                %div{:class => "col-sm-10"}
                  = f.label "Show customer thumbnails", :class => "control-label"
                  .pull-right= f.text_field :show_customer_thumbnails, :value => "#{@user_setting.show_customer_thumbnails? ? '1' : '0'}", "data-icon-checked" => "<i class='fa fa-check'></i>", "data-toggle" => "checkbox-x", "data-three-state" => "false", "data-size" => "xl"

            %li.list-group-item
              .row.form-group
                %div{:class => "col-sm-10"}
                  = f.label "Show ticket thumbnails", :class => "control-label"
                  .pull-right= f.text_field :show_ticket_thumbnails, :value => "#{@user_setting.show_ticket_thumbnails? ? '1' : '0'}", "data-icon-checked" => "<i class='fa fa-check'></i>", "data-toggle" => "checkbox-x", "data-three-state" => "false", "data-size" => "xl"

            %li.list-group-item
              .row.form-group
                %div{:class => "col-sm-10"}
                  = f.label "Show picture search thumbnails", :class => "control-label"
                  .pull-right= f.text_field :show_thumbnails, :value => "#{@user_setting.show_thumbnails? ? '1' : '0'}", "data-icon-checked" => "<i class='fa fa-check'></i>", "data-toggle" => "checkbox-x", "data-three-state" => "false", "data-size" => "xl"
            = f.hidden_field :table_name, value: "images"

            %li.list-group-item
              .row.form-group
                %div{:class => "col-sm-10"}
                  = f.label "Currency", :class => "control-label"
                  .pull-right= f.select :currency_id, options_for_select(@currencies.map{ |currency| [currency['Description'], currency['Id']] }, @user_setting.currency_id), {:include_blank => 'None'}, {:class => "form-control input-lg", required: true}

      .col-xs-12.col-sm-6
        %div.panel.panel-default
          %div.panel-heading
            %h5 Device Group
          %ul.list-group
            %li.list-group-item
              .row.form-group
                %div{:class => "col-sm-10"}
                  = f.select :device_group_id, options_from_collection_for_select(Yard.device_groups(current_yard_id), :id, :DeviceGroupName, @user_setting.device_group_id), {:include_blank => 'None'}, {:class => "form-control input-lg"}

      .col-xs-12.col-sm-6
        - unless @contract.blank?
          %div.panel.panel-default
            .panel-heading
              %h5
                Contract
                .pull-right= link_to 'Edit', edit_contract_path(@contract)
            %ul.list-group
              %li.list-group-item
                = @contract.contract_name
                %br
                = @contract.verbiage.html_safe
        - else
          %div.panel.panel-default
            .panel-heading
              %h5
                Contract
                .pull-right= link_to 'New', new_contract_path
            %ul.list-group
              %li.list-group-item
                No existing contract
      
      .col-xs-12.col-sm-6
        %div.panel.panel-default
          .panel-heading
            %h5 Yards
          %ul.list-group
            - Yard.all(current_user.token).each do |yard|
              %li.list-group-item{:class => (yard['Id'] == current_yard_id) ? "list-group-item-warning" : ""}= link_to yard["Name"], yard_path(yard['Id']), class: 'yard_button', data: {disable_with: "<i class='fa fa-spinner fa-spin'></i> Changing yard to #{yard['Name']}"}

        = button_tag(:type => 'submit', :class => 'btn btn-primary btn-lg btn-block', id: 'save_button', name: 'save', data: {disable_with: "<i class='fa fa-spinner fa-spin'></i> Update"}, autocomplete: "off") do
          Update